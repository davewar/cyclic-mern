(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{30:function(e,t,c){},39:function(e,t,c){"use strict";c.r(t);var s=c(1),a=c.n(s),n=c(23),r=c.n(n),i=(c(30),c(3)),l=c.n(i),o=c(5),j=c(4),d=c(12),b="/products",u="/signup",m="/signin",h="/product_create",O="/history",x=c(6),p=c(0),f=function(){return Object(p.jsx)("div",{className:"container",children:Object(p.jsx)("div",{className:"row",children:Object(p.jsxs)("div",{className:"col-xs-12",children:[Object(p.jsx)("h1",{className:"text-center mt-5 ",children:"Welcome to My fullstack website"}),Object(p.jsx)("h5",{className:"mt-5",children:"FrontEnd"}),Object(p.jsxs)("ul",{className:"list-unstyled",children:[Object(p.jsx)("li",{children:"- React"}),Object(p.jsx)("li",{children:"- Bootstrap"}),Object(p.jsx)("li",{children:"- Paypal"}),Object(p.jsx)("li",{children:"- Login/Register "}),Object(p.jsx)("li",{children:"- Admin user - Add / Delete / Amend Products"}),Object(p.jsx)("li",{children:"- Activate account by validating email address of user (Nodemailer)"}),Object(p.jsx)("li",{children:"- Password Reset (Nodemailer)"}),Object(p.jsx)("li",{children:"- Account locked - password incorrect three times in a row"})]}),Object(p.jsx)("h5",{className:"mt-5",children:"BackEnd"}),Object(p.jsxs)("ul",{className:"list-unstyled",children:[Object(p.jsx)("li",{children:"- NodeJS"}),Object(p.jsx)("li",{children:"- Express"}),Object(p.jsx)("li",{children:"- MongoDB"}),Object(p.jsx)("li",{children:"- JWT AccessToken && RefreshToken + HTTP only cookie"})]}),Object(p.jsx)("button",{className:"btn btn-primary",onClick:function(){window.open("https://github.com/davewar/React_shop_Nodemailer")},children:"GitHub Code"})]})})})},v=function(){return Object(p.jsxs)("div",{children:[Object(p.jsx)("h1",{children:"Error Page"}),Object(p.jsx)(j.b,{to:"/",children:"Back Home"})]})},g=c(17),N=c(8),y=c(25),w=c(2),S=function(e){localStorage.setItem("basket",JSON.stringify(e))},k=function(){localStorage.removeItem("basket")},C=Object(s.createContext)(),P=function(e){var t=e.children,c=Object(s.useState)([]),a=Object(w.a)(c,2),n=a[0],r=a[1],i=Object(s.useState)(0),l=Object(w.a)(i,2),o=l[0],j=l[1],d=Object(s.useState)([]),b=Object(w.a)(d,2),u=b[0],m=b[1],h=Object(s.useState)([]),O=Object(w.a)(h,2),x=O[0],f=O[1],v=Object(s.useState)("all"),g=Object(w.a)(v,2),P=g[0],E=g[1],A=Object(s.useState)(""),I=Object(w.a)(A,2),T=I[0],_=I[1];return Object(p.jsx)(C.Provider,{value:{products:n,setProducts:r,cart:u,setCart:m,addItem:function(e){var t=e.price,c=e._id,s=e.title,a=e.image,n=e.countInStock,r={_id:c,title:s,price:t,countInStock:n,image:a,count:1};if(u.every((function(e){return e._id!==c}))){var i=[].concat(Object(y.a)(u),[r]);m(i),S(i),alert("Item added to cart.")}else{var l=u.map((function(e){return e._id===c?Object(N.a)(Object(N.a)({},e),{},{count:e.count+1}):e}));m(l),S(l),alert("Item added to cart.")}},reduceQty:function(e){var t=u.map((function(t){return t._id===e?1===t.count?Object(N.a)(Object(N.a)({},t),{},{count:t.count=1}):Object(N.a)(Object(N.a)({},t),{},{count:t.count-1}):t}));m(t),S(t)},increaseQty:function(e){var t=u.map((function(t){return t._id===e?Object(N.a)(Object(N.a)({},t),{},{count:t.count+1}):t}));m(t),S(t)},removeItem:function(e){var t=u.filter((function(t){return t._id!==e}));m(t),S(t)},clearBasket:function(){m([]),j(0),k()},total:o,getTotal:function(){var e=u.reduce((function(e,t){return e+t.price*t.count}),0);j(e)},categorySelection:P,setCategorySelection:E,search:T,setSearch:_,categorysGlobal:x,setCategorysGlobal:f},children:t})},E=Object(s.createContext)(),A=function(e){var t=e.children,c=Object(s.useState)(""),a=Object(w.a)(c,2),n=a[0],r=a[1],i=Object(s.useState)(""),j=Object(w.a)(i,2),d=j[0],b=j[1],u=Object(s.useState)(!1),m=Object(w.a)(u,2),h=m[0],O=m[1],x=Object(s.useState)(!1),f=Object(w.a)(x,2),v=f[0],g=f[1],N=Object(s.useState)([]),y=Object(w.a)(N,2),S=y[0],k=y[1];return Object(s.useEffect)((function(){d&&function(){var e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/user/infor",{headers:{Authorization:d}});case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,O(!0),r(c.name),1===c.role?g(!0):g(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("DW",e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}()()}),[d]),Object(p.jsx)(E.Provider,{value:{user:n,setUser:r,isLogged:h,setIsLogged:O,isAdmin:v,setIsAdmin:g,accessToken:d,setAccessToken:b,history:S,setHistory:k},children:t})},I=function(){var e=Object(s.useContext)(C).cart,t=Object(s.useContext)(E),c=t.isLogged,a=t.isAdmin,n=t.setIsLogged,r=t.setIsAdmin,i=t.setAccessToken,d=t.setUser,x=t.user,f=function(){var e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user/logout");case 2:localStorage.removeItem("firstLogin"),n(!1),r(!1),i(""),d("");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-12",children:Object(p.jsx)("h4",{className:"mt-2 d-flex justify-content-center",children:x})})}),Object(p.jsxs)("div",{className:"row",children:[Object(p.jsx)("div",{className:"col-6",children:Object(p.jsx)("nav",{className:" navbar-nav navbar-expand-md navbar-light",children:Object(p.jsxs)("ul",{className:"navbar-nav justify-content-between",children:[Object(p.jsx)("li",{className:"nav-item",children:Object(p.jsx)(j.b,{className:"nav-item nav-link active",to:"/",children:"Home"})}),Object(p.jsx)("li",{className:"nav-item",children:Object(p.jsx)(j.b,{className:"nav-item nav-link",to:b,children:"Products"})}),c&&Object(p.jsx)("li",{className:"nav-item",children:Object(p.jsx)(j.b,{className:"nav-item nav-link",to:O,children:"Account"})}),!c&&Object(p.jsx)("li",{className:"nav-item",children:Object(p.jsx)(j.b,{className:"nav-item nav-link",to:m,children:"SignIn"})}),c&&Object(p.jsx)("li",{className:"nav-item",children:Object(p.jsx)(j.b,{className:"nav-item nav-link",onClick:f,to:"/",children:"SignOut"})}),!c&&Object(p.jsx)("li",{className:"nav-item",children:Object(p.jsx)(j.b,{className:"nav-item nav-link",to:u,children:"Register"})}),a&&c&&Object(p.jsx)("li",{className:"nav-item ",children:Object(p.jsx)(j.b,{className:"nav-item nav-link text-success  ",to:h,children:"AddProduct"})})]})})}),Object(p.jsx)("div",{className:"col-6",children:Object(p.jsx)("div",{className:"d-flex mr-5 mt-5 justify-content-end",children:Object(p.jsxs)("span",{children:[Object(p.jsx)(j.b,{to:"/cart",children:Object(p.jsx)(g.a,{style:{height:"2rem",color:"black",width:"2rem"}})}),Object(p.jsx)("span",{className:" border rounded-circle",style:{height:"1rem",color:"white",backgroundColor:"black",width:"1rem"},children:function(){var t=0;return e?(e.forEach((function(e){var c=e.count;t+=c})),t):t}()})]})})})]})]})},T=function(){var e=Object(s.useContext)(C),t=e.search,c=e.setSearch,a=e.categorySelection,n=e.setCategorySelection,r=e.setCategorysGlobal,i=Object(s.useState)(null),j=Object(w.a)(i,2),d=j[0],b=j[1],u=Object(s.useState)(!0),m=Object(w.a)(u,2),h=m[0],O=m[1],x=Object(s.useState)(!1),f=Object(w.a)(x,2),v=f[0],g=f[1],N=function(){var e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/category");case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,b(c),r(c),O(!1),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0.message),g(!0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){return N(),function(){!1}}),[]);return Object(p.jsxs)(p.Fragment,{children:[h&&Object(p.jsx)("div",{children:"Loading........"}),v&&Object(p.jsx)("div",{children:"Error with loading of page. Please refresh page."}),Object(p.jsx)("div",{className:"container ms-1  mb-5",children:d&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-8-md  mb-2",children:Object(p.jsx)("div",{className:"form-group",children:Object(p.jsx)("input",{type:"text",className:"form-control",value:t,onChange:function(e){return c(e.target.value)},placeholder:"Search..."})})})}),Object(p.jsx)("div",{className:"row",children:Object(p.jsxs)("div",{className:"col-6 mb-2",children:[Object(p.jsx)("span",{children:" Filters: "}),Object(p.jsxs)("select",{name:"category",value:a,onChange:function(e){var t=e.target.value;n(t)},children:[Object(p.jsx)("option",{value:"all",children:"All Products"}),d.map((function(e){return Object(p.jsx)("option",{value:e.name,children:e.name},e._id)}))]})]})})]})})]})},_={width:"40%",minWidth:"500px"},F=function(){var e,t=Object(s.useContext)(C),c=(t.msg,t.addItem),a=t.products,n=t.setProducts,r=t.search,i=t.categorySelection,d=Object(s.useContext)(E),b=d.isAdmin,u=d.accessToken,m=Object(s.useState)(!0),h=Object(w.a)(m,2),O=h[0],x=h[1],f=Object(s.useState)(!1),v=Object(w.a)(f,2),g=v[0],N=v[1],y=function(){var e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/products");case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,n(c),x(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message),N(!0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(o.a)(l.a.mark((function e(t){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/products/"+t,{method:"DELETE",body:JSON.stringify({id:t}),headers:{"Content-Type":"application/json",credentials:"include",Authorization:u}});case 3:return c=e.sent,e.next=6,c.json();case 6:"item deleted"!==(s=e.sent)?alert("Admin access lasts 10 mins, please refresh page and try again."):alert(s),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message),N(!0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){return y(),function(){!1}}),[]),e=(e="all"===i?a:a.filter((function(e){return e.category.toLowerCase()===i.toLowerCase()}))).filter((function(e){return e.title.toLowerCase().includes(r.toLowerCase())})),Object(p.jsxs)(p.Fragment,{children:[O&&Object(p.jsx)("div",{children:"Loading........"}),g&&Object(p.jsx)("div",{children:"Error with loading of page. Please refresh page."}),Object(p.jsx)(T,{}),Object(p.jsx)("div",{className:"d-flex flex-row flex-wrap",children:e.map((function(e){return Object(p.jsxs)("div",{className:"card m-3",style:_,children:[Object(p.jsx)("img",{src:e.image,className:"card-img-top",alt:""}),Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsx)("h2",{className:"card-title",children:e.title}),Object(p.jsxs)("p",{className:"card-text",children:["Category: ",e.category]}),Object(p.jsxs)("span",{children:["Price: \xa3",e.price]}),b&&Object(p.jsxs)("p",{className:"card-text",children:["Stock: ",e.countInStock]}),Object(p.jsxs)("p",{className:"card-text",children:["Description: ",e.description]})]}),Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsx)("button",{className:"btn btn-primary border",onClick:function(){return c(e)},children:"BUY"}),Object(p.jsx)("button",{className:"btn border",children:Object(p.jsx)(j.b,{to:"/products/".concat(e._id),children:"VIEW"})})]}),b&&Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsx)("button",{className:"btn btn-danger border",onClick:function(){return S(e._id)},children:"DELETE"}),Object(p.jsx)("button",{className:"btn btn-warning border",children:Object(p.jsx)(j.b,{to:"/product_amend/".concat(e._id),children:"EDIT"})})]})]},e._id)}))}),O||0!==e.length?null:Object(p.jsx)("h1",{children:"No items found"})]})},L=function(){var e=Object(s.useContext)(C),t=e.addItem,c=e.products,a=Object(s.useState)([]),n=Object(w.a)(a,2),r=n[0],i=n[1],l=Object(s.useState)(!0),o=Object(w.a)(l,2),d=o[0],u=o[1],m=Object(s.useState)(!1),h=Object(w.a)(m,2),O=h[0],f=h[1],v=Object(x.h)().id;Object(s.useEffect)((function(){try{var e=c.filter((function(e){return e._id===v}));i(e[0]),u(!1)}catch(t){console.log(t.message),f(!0)}return function(){return!0}}),[]);var g=r._id,N=r.title,y=r.description,S=r.price,k=r.image;return Object(p.jsxs)(p.Fragment,{children:[d&&Object(p.jsx)("div",{children:"Loading........"}),O&&Object(p.jsx)("div",{children:"Error with loading of page. Please refresh page."}),r?Object(p.jsxs)("div",{className:"card",children:[Object(p.jsx)("img",{className:"card-img-top",src:k,alt:N}),Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsx)("h2",{className:"card-title",children:N}),Object(p.jsxs)("span",{children:["Price: \xa3 ",S]}),Object(p.jsx)("p",{className:"card-text",children:y})]}),Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsx)("button",{className:"btn btn-primary border",onClick:function(){return t(r)},children:"BUY"}),Object(p.jsx)("button",{className:"btn border",children:Object(p.jsx)(j.b,{to:b,children:"Back to products"})})]})]},g):Object(p.jsx)("h1",{children:"Unable to display item. Please try later"})]})},D={width:"40%",minWidth:"450px"},z=function(){var e=Object(s.useContext)(C),t=e.cart,c=(e.setCart,e.increaseQty),a=e.reduceQty,n=e.removeItem,r=e.clearBasket,i=e.total,l=e.getTotal,o=Object(s.useContext)(E),d=(o.accessToken,o.isLogged);o.isAdmin;if(Object(s.useEffect)((function(){return l(),function(){return!0}}),[t]),!t||0===t.length)return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{children:"No Items in basket"}),Object(p.jsx)("button",{className:"btn border",children:Object(p.jsx)(j.b,{to:"/products",children:"CONTINUE SHOPPING"})})]});return d?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"row",children:[Object(p.jsx)("div",{className:"col-6 d-flex justify-content-start",children:Object(p.jsx)("h1",{className:"text-center text-uppercase text-secondary ",children:"Cart"})}),Object(p.jsx)("div",{className:"col-6 d-flex justify-content-end",children:Object(p.jsxs)("h3",{className:"text-center",children:["Total - \xa3 ",i]})})]}),Object(p.jsx)("div",{className:"row ",children:Object(p.jsx)("div",{className:"col-12 d-flex justify-content-start",children:Object(p.jsx)("button",{className:"btn btn-secondary",onClick:function(){return r()},children:"REMOVE ALL ITEMS"})})}),Object(p.jsx)("div",{className:"row mb-5",children:Object(p.jsx)("div",{className:"col-12 d-flex justify-content-end"})}),Object(p.jsx)("div",{className:"container",children:Object(p.jsx)("div",{className:"d-flex flex-row flex-wrap justify-content-between",children:t?t.map((function(e){return Object(p.jsxs)("div",{className:"card mt-2 mb-4 t h-25",style:D,children:[Object(p.jsx)("img",{src:e.image,className:"card-img-top",alt:""}),Object(p.jsx)("div",{className:"card-body d-flex justify-content-end ",children:Object(p.jsx)("button",{className:"btn ",onClick:function(){return n(e._id)},children:Object(p.jsx)(g.b,{style:{height:"2rem",color:"black",width:"2rem"}})})}),Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsx)("h1",{className:"card-title",children:e.title}),Object(p.jsxs)("p",{className:"card-text",children:["Price: \xa3",e.price]}),Object(p.jsxs)("h4",{children:["Total Price: \xa3",e.price*e.count]})]}),Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsxs)("button",{className:"btn btn primary border mr-2",onClick:function(){return a(e._id)},children:[" ","-"," "]}),Object(p.jsx)("span",{className:"",children:e.count}),Object(p.jsxs)("button",{className:"btn btn primary border ml-2",onClick:function(){return c(e._id)},children:[" ","+"," "]})]}),Object(p.jsx)("button",{className:"btn border",children:Object(p.jsx)(j.b,{to:"/products",children:"CONTINUE SHOPPING"})})]},e._id)})):null})})]}):Object(p.jsx)(x.a,{to:"/signin"})},B=function(){var e=Object(s.useContext)(E).setAccessToken,t=Object(x.g)(),c=Object(s.useState)(""),a=Object(w.a)(c,2),n=a[0],r=a[1],i=Object(s.useState)(""),d=Object(w.a)(i,2),b=d[0],u=d[1],m=Object(s.useState)(""),h=Object(w.a)(m,2),O=h[0],f=h[1],v=Object(s.useState)(""),g=Object(w.a)(v,2),N=g[0],y=g[1],S=Object(s.useState)(""),k=Object(w.a)(S,2),C=k[0],P=k[1],A=function(e,t){r("");var c={},s=RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);switch(c[t]=e.target.value,t){case"email":u(c.email),s.test(c.email)?y(""):y("Invalid Email!");break;case"password":f(c.password),c.password.length<6?P("Password must be at least 6 characters!"):P("")}},I=function(){var c=Object(o.a)(l.a.mark((function c(s){var a,n;return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(s.preventDefault(),!b||!O||N||C){c.next=16;break}return r(""),c.prev=3,c.next=6,fetch("/user/login",{method:"POST",body:JSON.stringify({email:b,password:O}),headers:{"Content-Type":"application/json",credentials:"include"}});case 6:return a=c.sent,c.next=9,a.json();case 9:(n=c.sent).errors?r(n.errors):n.user&&(localStorage.setItem("firstLogin",!0),e(n.accesstoken),t.push("products")),c.next=16;break;case 13:c.prev=13,c.t0=c.catch(3),console.log(c.t0);case 16:case"end":return c.stop()}}),c,null,[[3,13]])})));return function(e){return c.apply(this,arguments)}}();return Object(p.jsx)("div",{className:"container ",children:Object(p.jsx)("div",{className:"row mt-5  justify-content-center align-items-center  ",children:Object(p.jsxs)("div",{className:"col-xs-12  sign-in",children:[Object(p.jsx)("h2",{className:"text-start mt-3",children:"Sign In"}),n&&Object(p.jsx)("div",{className:"alert alert-danger text-center",children:Object(p.jsx)("span",{className:"text-danger text-capitalize",children:n})}),Object(p.jsxs)("form",{className:"mt-4 ",onSubmit:I,children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"mr-3",htmlFor:"email",children:"Enter Email Address"}),Object(p.jsx)("input",{type:"email",name:"email",className:N?"form-control is-invalid":!N&&b.length?"form-control is-valid":"form-control",id:"email",placeholder:"Email Address",required:!0,autoComplete:"on",onChange:function(e){return A(e,"email")}}),N&&Object(p.jsx)("small",{className:"text-danger",children:N})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"",htmlFor:"password",children:"Enter Password"}),Object(p.jsx)("input",{type:"password",name:"password",className:C?"form-control is-invalid":!C&&O.length?"form-control is-valid":"form-control",id:"password",placeholder:"Password",required:!0,autoComplete:"off",onChange:function(e){return A(e,"password")}}),C&&Object(p.jsx)("small",{className:"text-danger",children:C})]}),Object(p.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Sign In"})]}),Object(p.jsxs)("p",{className:"float-left mt-2",children:["Don't yet have an account?",Object(p.jsx)(j.b,{to:"/signup",children:"Sign up"})]}),Object(p.jsx)("div",{className:"mt-2 ms-2 ",children:Object(p.jsx)(j.b,{to:"/reset",children:"Forgot Password"})})]})})})},q=function(){Object(x.g)(),Object(s.useContext)(E).setAccessToken;var e=Object(s.useState)(""),t=Object(w.a)(e,2),c=t[0],a=t[1],n=Object(s.useState)(""),r=Object(w.a)(n,2),i=r[0],d=r[1],b=Object(s.useState)(""),u=Object(w.a)(b,2),m=u[0],h=u[1],O=Object(s.useState)(""),f=Object(w.a)(O,2),v=f[0],g=f[1],N=Object(s.useState)(""),y=Object(w.a)(N,2),S=y[0],k=y[1],C=Object(s.useState)(""),P=Object(w.a)(C,2),A=P[0],I=P[1],T=Object(s.useState)(""),_=Object(w.a)(T,2),F=_[0],L=_[1],D=Object(s.useState)(""),z=Object(w.a)(D,2),B=z[0],q=z[1],J=Object(s.useState)(""),H=Object(w.a)(J,2),G=H[0],R=H[1],U=Object(s.useState)(""),M=Object(w.a)(U,2),Z=M[0],W=M[1],Y=function(e,t){a("");var c={},s=RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);switch(c[t]=e.target.value,t){case"name":d(c.name),c.name.length<3?I("Name must be at least 3 characters!"):I("");break;case"email":h(c.email),s.test(c.email)?L(""):L("Invalid Email!");break;case"password":g(c.password),c.password.length<6?q("Password must be at least 6 characters!"):q("");break;case"confPassword":k(c.confPassword),c.confPassword!==v?R("Passwords do not match!"):R("")}},Q=function(){var e=Object(o.a)(l.a.mark((function e(t){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(i&&m&&v&&S)||A||F||B||G){e.next=18;break}return a(""),W(""),e.prev=4,e.next=7,fetch("/user/signup",{method:"POST",body:JSON.stringify({name:i,email:m,password:v}),headers:{"Content-Type":"application/json",credentials:"include"}});case 7:return c=e.sent,e.next=10,c.json();case 10:(s=e.sent).errors&&a(s.errors),s.msg&&W(s.msg),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.log(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)("div",{className:"container ",children:Object(p.jsx)("div",{className:"row mt-5  justify-content-center align-items-center ",children:Object(p.jsxs)("div",{className:"col-xs-12 sign-in ",children:[Object(p.jsx)("h2",{className:"text-center",children:"Create an Account"}),c&&Object(p.jsx)("div",{className:"alert alert-danger text-center",children:Object(p.jsx)("span",{className:"text-danger text-capitalize",children:c})}),Z&&Object(p.jsx)("div",{className:"alert alert-success text-center",children:Object(p.jsx)("span",{className:"text-success text-capitalize",children:Z})}),Object(p.jsxs)("form",{className:"mt-4",onSubmit:Q,children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{htmlFor:"name",children:"Enter Full Name"}),Object(p.jsx)("input",{type:"text",name:"name",className:A?"form-control is-invalid":!A&&i.length?"form-control is-valid":"form-control",id:"name",placeholder:"Full Name",onChange:function(e){return Y(e,"name")}}),A&&Object(p.jsx)("small",{className:"text-danger",children:A})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{htmlFor:"email",children:"Enter Email Address"}),Object(p.jsx)("input",{type:"email",name:"email",className:F?"form-control is-invalid":!F&&m.length?"form-control is-valid":"form-control",id:"email",placeholder:"Email Address",onChange:function(e){return Y(e,"email")}}),F&&Object(p.jsx)("small",{className:"text-danger",children:F})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{htmlFor:"password",children:"Enter Password"}),Object(p.jsx)("input",{type:"password",name:"password",className:B?"form-control is-invalid":!B&&v.length?"form-control is-valid":"form-control",id:"password",placeholder:"Password",onChange:function(e){return Y(e,"password")}}),B&&Object(p.jsx)("small",{className:"text-danger",children:B})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{htmlFor:"Confirm Password",children:"Confirm Password"}),Object(p.jsx)("input",{type:"password",name:"confPassword",className:G?"form-control is-invalid":G||B||!S?"form-control":"form-control is-valid",id:"confPassword",placeholder:"Password",onChange:function(e){return Y(e,"confPassword")}}),G&&Object(p.jsx)("small",{className:"text-danger",children:G})]}),Object(p.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Sign Up"})]}),Object(p.jsxs)("p",{className:"float-left",children:["Already have an account?",Object(p.jsx)(j.b,{to:"/signin",children:"Log In"})]})]})})})},J=function(){var e=Object(s.useContext)(E),t=e.history,c=e.setHistory,a=e.accessToken,n=e.isAdmin,r=Object(s.useState)(!0),i=Object(w.a)(r,2),d=i[0],u=i[1],m=Object(s.useState)(!1),h=Object(w.a)(m,2),O=h[0],x=h[1];return Object(s.useEffect)((function(){return function(){var e=Object(o.a)(l.a.mark((function e(){var t,s,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=19;break}return e.prev=1,e.next=4,fetch("/api/payments",{headers:{Authorization:a}});case 4:return t=e.sent,e.next=7,t.json();case 7:s=e.sent,c(s),u(!1),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0.message),c([]),x(!0);case 17:e.next=35;break;case 19:return e.prev=19,e.next=22,fetch("/user/history",{headers:{Authorization:a}});case 22:return r=e.sent,e.next=25,r.json();case 25:i=e.sent,c(i),u(!1),e.next=35;break;case 30:e.prev=30,e.t1=e.catch(19),console.log(e.t1.message),c([]),x(!0);case 35:case"end":return e.stop()}}),e,null,[[1,12],[19,30]])})));return function(){return e.apply(this,arguments)}}()(),function(){return!0}}),[a,c,n]),O?Object(p.jsx)("div",{children:"Error with loading of page. Please refresh page."}):Object(p.jsxs)(p.Fragment,{children:[d&&Object(p.jsx)("div",{children:"Loading........"}),O&&Object(p.jsx)("div",{children:"Error with loading of page. Please refresh page."}),t.length>0?Object(p.jsxs)("div",{className:"container",children:[Object(p.jsxs)("div",{className:"row ",children:[Object(p.jsx)("h2",{children:"Account History"}),Object(p.jsx)("button",{className:"btn ",children:Object(p.jsx)(j.b,{to:b,children:"Back to products"})})]}),Object(p.jsxs)("p",{children:["You have ",t.length," purchases"]}),Object(p.jsxs)("table",{className:"table table-hover ",children:[Object(p.jsx)("thead",{className:"thead-dark",children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scope:"col",children:"Payment ID"}),Object(p.jsx)("th",{scope:"col",children:"Date of Purchased"}),Object(p.jsx)("th",{scope:"col"})]})}),Object(p.jsx)("tbody",{children:t.map((function(e){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:e.paymentID}),Object(p.jsx)("td",{children:new Date(e.createdAt).toLocaleDateString()}),Object(p.jsx)("td",{children:Object(p.jsx)(j.b,{to:"/history/".concat(e._id),children:"View"})})]},e._id)}))})]})]}):Object(p.jsx)("p",{children:"You have 0 purchases"})]})};var H=function(){var e=Object(s.useContext)(E).history,t=Object(s.useState)([]),c=Object(w.a)(t,2),a=c[0],n=c[1],r=Object(x.h)().id;return Object(s.useEffect)((function(){r&&e.forEach((function(e){e._id===r&&n(e)}))}),[r,e]),0===a.length?null:Object(p.jsxs)("div",{className:"container mt-1",children:[Object(p.jsx)("button",{className:"btn",children:Object(p.jsx)(j.b,{to:O,children:"Back to accounts"})}),Object(p.jsxs)("table",{className:"table table-bordered mt-3",children:[Object(p.jsx)("thead",{className:"thead-dark",children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"Name"}),Object(p.jsx)("th",{children:"Address"}),Object(p.jsx)("th",{children:"Postal Code"}),Object(p.jsx)("th",{children:"Country Code"})]})}),Object(p.jsx)("tbody",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:a.address.recipient_name}),Object(p.jsx)("td",{children:a.address.line1+" - "+a.address.city}),Object(p.jsx)("td",{children:a.address.postal_code}),Object(p.jsx)("td",{children:a.address.country_code})]})})]}),Object(p.jsxs)("table",{className:"table table-bordered",children:[Object(p.jsx)("thead",{className:"thead-dark",children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"Products"}),Object(p.jsx)("th",{children:"Quantity"}),Object(p.jsx)("th",{children:"Price"}),Object(p.jsx)("th",{children:"Total"}),Object(p.jsx)("th",{children:"Dispatched"})]})}),Object(p.jsx)("tbody",{children:a.cart.map((function(e){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:e.title}),Object(p.jsx)("td",{children:e.count}),Object(p.jsx)("td",{children:e.price}),Object(p.jsxs)("td",{children:["\xa3 ",e.price*e.count]}),Object(p.jsx)("td",{children:e.Sent?"Yes":"No"})]},e._id)}))})]})]})},G=function(){var e=Object(s.useState)(""),t=Object(w.a)(e,2),c=t[0],a=t[1],n=Object(s.useState)(""),r=Object(w.a)(n,2),i=r[0],j=r[1],d=Object(x.h)().id;console.log(d);var b=function(){var e=Object(o.a)(l.a.mark((function e(t){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/user/activation",{method:"POST",body:JSON.stringify({accesstoken:t}),headers:{"Content-Type":"application/json",credentials:"include"}});case 3:return c=e.sent,e.next=6,c.json();case 6:s=e.sent,console.log(s),s.errors?a(s.errors):j(s.msg),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message),a(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){return b(d),function(){return!1}}),[d]),Object(p.jsxs)("div",{className:"alert",children:[Object(p.jsx)("p",{className:"text-danger",children:c}),Object(p.jsx)("p",{className:"text-success",children:i})]})},R=function(){Object(s.useContext)(E).setAccessToken;var e=Object(s.useState)(""),t=Object(w.a)(e,2),c=t[0],a=t[1],n=Object(s.useState)(""),r=Object(w.a)(n,2),i=r[0],d=r[1],b=Object(s.useState)(""),u=Object(w.a)(b,2),m=u[0],h=u[1],O=Object(s.useState)(""),x=Object(w.a)(O,2),f=x[0],v=x[1],g=function(){var e=Object(o.a)(l.a.mark((function e(t){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!m||f){e.next=18;break}return a(""),d(""),e.prev=4,e.next=7,fetch("/user/forgot",{method:"POST",body:JSON.stringify({email:m}),headers:{"Content-Type":"application/json",credentials:"include"}});case 7:return c=e.sent,e.next=10,c.json();case 10:(s=e.sent).errors?a(s.errors):d(s.msg),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0),a(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)("div",{className:"container ",children:Object(p.jsx)("div",{className:"row mt-5  justify-content-center align-items-center  ",children:Object(p.jsxs)("div",{className:"col-xs-12  sign-in",children:[Object(p.jsx)("h2",{className:"text-start mt-3",children:"Forgot Password"}),c&&Object(p.jsx)("div",{className:"alert alert-danger text-center",children:Object(p.jsx)("span",{className:"text-danger text-capitalize",children:c})}),i&&Object(p.jsx)("div",{className:"alert alert-success text-center",children:Object(p.jsx)("span",{className:"text-success text-capitalize",children:i})}),Object(p.jsxs)("form",{className:"mt-4 ",onSubmit:g,children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"mr-3",htmlFor:"email",children:"Enter Email Address"}),Object(p.jsx)("input",{type:"email",name:"email",className:f?"form-control is-invalid":!f&&m.length?"form-control is-valid":"form-control",id:"email",placeholder:"Email Address",required:!0,autoComplete:"on",onChange:function(e){return function(e,t){a(""),d(""),v("");var c={},s=RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);switch(c[t]=e.target.value,t){case"email":h(c.email),s.test(c.email)?v(""):v("Invalid Email!")}}(e,"email")}}),f&&Object(p.jsx)("small",{className:"text-danger",children:f})]}),Object(p.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Submit"})]}),Object(p.jsxs)("p",{className:"float-left mt-5",children:["Back to",Object(p.jsx)(j.b,{to:"/signin",children:"Sign in"})]})]})})})},U=function(){Object(x.g)();var e=Object(x.h)().id,t=(Object(s.useContext)(E).setAccessToken,Object(s.useState)("")),c=Object(w.a)(t,2),a=c[0],n=c[1],r=Object(s.useState)(""),i=Object(w.a)(r,2),d=i[0],b=i[1],u=Object(s.useState)(""),m=Object(w.a)(u,2),h=m[0],O=m[1],f=Object(s.useState)(""),v=Object(w.a)(f,2),g=v[0],N=v[1],y=Object(s.useState)(""),S=Object(w.a)(y,2),k=S[0],C=S[1],P=Object(s.useState)(""),A=Object(w.a)(P,2),I=A[0],T=A[1],_=Object(s.useState)(""),F=Object(w.a)(_,2),L=F[0],D=F[1],z=Object(s.useState)(""),B=Object(w.a)(z,2),q=B[0],J=B[1],H=function(e,t){n("");var c={},s=RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);switch(c[t]=e.target.value,t){case"email":b(c.email),s.test(c.email)?C(""):C("Invalid Email!");break;case"password":O(c.password),c.password.length<6?T("Password must be at least 6 characters!"):T("");break;case"confPassword":N(c.confPassword),c.confPassword!==h?D("Passwords do not match!"):D("")}},G=function(){var t=Object(o.a)(l.a.mark((function t(c){var s,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c.preventDefault(),!(d&&h&&g)||k||I||L){t.next=19;break}return n(""),J(""),t.prev=4,t.next=7,fetch("/user/reset",{method:"POST",body:JSON.stringify({email:d,password:h,accesstoken:e}),headers:{"Content-Type":"application/json",credentials:"include"}});case 7:return s=t.sent,t.next=10,s.json();case 10:a=t.sent,console.log(a),a.errors&&n(a.errors),a.msg&&(console.log(a),J(a.msg)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),console.log(t.t0.message);case 19:case"end":return t.stop()}}),t,null,[[4,16]])})));return function(e){return t.apply(this,arguments)}}();return Object(p.jsx)("div",{className:"container ",children:Object(p.jsx)("div",{className:"row mt-5  justify-content-center align-items-center ",children:Object(p.jsxs)("div",{className:"col-xs-12 sign-in ",children:[Object(p.jsx)("h2",{className:"text-center",children:"Create your Password"}),a&&Object(p.jsx)("div",{className:"alert alert-danger text-center",children:Object(p.jsx)("span",{className:"text-danger text-capitalize",children:a})}),q&&Object(p.jsx)("div",{className:"alert alert-success text-center",children:Object(p.jsx)("span",{className:"text-success text-capitalize",children:q})}),Object(p.jsxs)("form",{className:"mt-4",onSubmit:G,children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{htmlFor:"email",children:"Enter Email Address"}),Object(p.jsx)("input",{type:"email",name:"email",className:k?"form-control is-invalid":!k&&d.length?"form-control is-valid":"form-control",id:"email",placeholder:"Email Address",onChange:function(e){return H(e,"email")}}),k&&Object(p.jsx)("small",{className:"text-danger",children:k})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{htmlFor:"password",children:"Enter Password"}),Object(p.jsx)("input",{type:"password",name:"password",className:I?"form-control is-invalid":!I&&h.length?"form-control is-valid":"form-control",id:"password",placeholder:"Password",onChange:function(e){return H(e,"password")}}),I&&Object(p.jsx)("small",{className:"text-danger",children:I})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{htmlFor:"Confirm Password",children:"Confirm Password"}),Object(p.jsx)("input",{type:"password",name:"confPassword",className:L?"form-control is-invalid":L||I||!g?"form-control":"form-control is-valid",id:"confPassword",placeholder:"Password",onChange:function(e){return H(e,"confPassword")}}),L&&Object(p.jsx)("small",{className:"text-danger",children:L})]}),Object(p.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Submit"})]}),Object(p.jsx)("p",{className:"float-left mt-5",children:Object(p.jsx)(j.b,{to:"/signin",children:"Log In"})})]})})})},M={title:"",image:"",price:"",description:"",category:"",countInStock:""};var Z=function(){var e=Object(s.useContext)(E),t=e.isAdmin,c=e.accessToken,a=Object(s.useContext)(C),n=a.categorysGlobal,r=a.setCategorysGlobal,i=Object(s.useState)(M),j=Object(w.a)(i,2),b=j[0],u=j[1],m=Object(s.useState)(!0),h=Object(w.a)(m,2),O=h[0],x=h[1],f=Object(s.useState)(!1),v=Object(w.a)(f,2),g=v[0],y=v[1],S=function(){var e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/category");case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,r(c),x(!1),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message),x(!1),y(!0);case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){return S(),function(){!1}}),[]);var k=function(e){var t=e.target,c=t.name,s=t.value;("price"===c||"countInStock"===c)&&s<0||u(Object(N.a)(Object(N.a)({},b),{},Object(d.a)({},c,s)))},P=function(){var e=Object(o.a)(l.a.mark((function e(s){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),e.prev=1,t){e.next=4;break}return e.abrupt("return",alert("Unauthorised"));case 4:if(""!==b.category){e.next=7;break}return alert("Please select a category"),e.abrupt("return");case 7:return e.next=9,fetch("/api/products/add",{method:"POST",body:JSON.stringify(Object(N.a)({},b)),headers:{"Content-Type":"application/json",credentials:"include",Authorization:c}});case 9:return a=e.sent,e.next=12,a.json();case 12:n=e.sent,console.log(n),"item added"!==n?alert("Admin access lasts 10 mins, please refresh page and try again."):(alert(n),u(M)),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),alert(e.t0.message);case 20:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[O&&Object(p.jsx)("div",{children:"Loading........"}),g&&Object(p.jsx)("div",{children:"Error with loading of page. Please refresh page."}),n&&Object(p.jsxs)("form",{onSubmit:P,children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Title"}),Object(p.jsx)("input",{type:"text",name:"title",className:"form-control",required:!0,placeholder:"Shirt",value:b.title,onChange:k})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Image"}),Object(p.jsx)("input",{type:"text",name:"image",className:"form-control",required:!0,placeholder:"https://images.unsplash.com/photo-1606813907291-d86efa9b94db?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1352&q=80",value:b.image,onChange:k})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Price"}),Object(p.jsx)("input",{type:"number",name:"price",className:"form-control",required:!0,placeholder:"1.00",value:b.price,onChange:k})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Description"}),Object(p.jsx)("textarea",{type:"text",name:"description",className:"form-control",required:!0,placeholder:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Non assumenda maiores vero, consequuntur",value:b.description,rows:"5",onChange:k})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Categories: "}),Object(p.jsxs)("select",{name:"category",value:b.category,className:"form-control",onChange:k,children:[Object(p.jsx)("option",{value:"",children:"Please select a category"}),n.map((function(e){return Object(p.jsx)("option",{value:e.name,children:e.name},e._id)}))]})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Stock Count"}),Object(p.jsx)("input",{type:"number",name:"countInStock",className:"form-control",required:!0,placeholder:"0",value:b.countInStock,onChange:k})]}),Object(p.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Add"})]})]})};var W=function(){var e=Object(x.h)().id,t=Object(s.useContext)(E),c=t.isAdmin,a=t.accessToken,n=Object(s.useContext)(C),r=n.categorysGlobal,i=n.products,u=Object(s.useState)(),m=Object(w.a)(u,2),h=m[0],O=m[1],f=Object(s.useState)(!0),v=Object(w.a)(f,2),g=v[0],y=v[1],S=Object(s.useState)(!1),k=Object(w.a)(S,2),P=k[0],A=k[1];Object(s.useEffect)((function(){try{var t=i.filter((function(t){return t._id===e}));O(t[0]),y(!1)}catch(c){console.log(c.message),A(!0)}return function(){return!0}}),[]);var I=function(e){var t=e.target,c=t.name,s=t.value;console.log(c,s),("price"===c||"countInStock"===c)&&s<0||O(Object(N.a)(Object(N.a)({},h),{},Object(d.a)({},c,s)))},T=function(){var t=Object(o.a)(l.a.mark((function t(s){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),t.prev=1,c){t.next=4;break}return t.abrupt("return",alert("Unauthorised"));case 4:if(""!==h.category){t.next=7;break}return alert("Please select a category"),t.abrupt("return");case 7:return console.log(h),t.next=10,fetch("/api/products/update/"+e,{method:"POST",body:JSON.stringify(Object(N.a)({},h)),headers:{"Content-Type":"application/json",credentials:"include",Authorization:a}});case 10:return n=t.sent,t.next=13,n.json();case 13:r=t.sent,console.log(r),"item updated"!==r?alert("Admin access lasts 10 mins, please refresh page and try again."):alert(r),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(1),alert(t.t0.message);case 21:case"end":return t.stop()}}),t,null,[[1,18]])})));return function(e){return t.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[g&&Object(p.jsx)("div",{children:"Loading........"}),P&&Object(p.jsx)("div",{children:"Error with loading of page. Please refresh page."}),h&&Object(p.jsxs)("form",{onSubmit:T,children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Title"}),Object(p.jsx)("input",{type:"text",name:"title",className:"form-control",required:!0,value:h.title,onChange:I})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Image"}),Object(p.jsx)("input",{type:"text",name:"image",className:"form-control",required:!0,value:h.image,onChange:I})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Price"}),Object(p.jsx)("input",{type:"number",name:"price",className:"form-control",required:!0,value:h.price,onChange:I})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Description"}),Object(p.jsx)("textarea",{type:"text",name:"description",className:"form-control",required:!0,value:h.description,rows:"5",onChange:I})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Categories: "}),Object(p.jsx)("select",{name:"category",value:h.category,className:"form-control",onChange:I,children:r.map((function(e){return Object(p.jsx)("option",{value:e.name,children:e.name},e._id)}))})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{children:"Stock Count"}),Object(p.jsx)("input",{type:"number",name:"countInStock",className:"form-control",required:!0,value:h.countInStock,onChange:I})]}),Object(p.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Save"}),Object(p.jsx)("button",{className:"btn border",children:Object(p.jsx)(j.b,{to:b,children:"Back to products"})}),Object(p.jsx)("div",{})]})]})},Y=function(){var e;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(j.a,{children:[Object(p.jsx)(I,{}),Object(p.jsxs)(x.d,{children:[Object(p.jsx)(x.b,{exact:!0,path:"/",component:f}),Object(p.jsx)(x.b,(e={exact:!0,path:b},Object(d.a)(e,"exact",!0),Object(d.a)(e,"component",F),e)),Object(p.jsx)(x.b,{exact:!0,path:"/products/:id",component:L}),Object(p.jsx)(x.b,{path:"/cart",component:z}),Object(p.jsx)(x.b,{path:O,exact:!0,component:J}),Object(p.jsx)(x.b,{exact:!0,path:"/history/:id",component:H}),Object(p.jsx)(x.b,{path:m,component:B}),Object(p.jsx)(x.b,{path:u,component:q}),Object(p.jsx)(x.b,{path:"/user/activate/:id",component:G,exact:!0}),Object(p.jsx)(x.b,{path:"/reset",component:R,exact:!0}),Object(p.jsx)(x.b,{path:"/reset_password/:id",component:U,exact:!0}),Object(p.jsx)(x.b,{path:h,exact:!0,component:Z}),Object(p.jsx)(x.b,{path:"/product_amend/:id",component:W}),Object(p.jsx)(x.b,{path:"*",children:Object(p.jsx)(v,{})})]})]})})};c(38);var Q=function(){var e=Object(s.useContext)(C).setCart,t=Object(s.useContext)(E).setAccessToken;return Object(s.useEffect)((function(){var t=JSON.parse(localStorage.getItem("basket"));t&&e(t)}),[]),Object(s.useEffect)((function(){localStorage.getItem("firstLogin")&&function(){var e=Object(o.a)(l.a.mark((function e(){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user/refresh_token",{credentials:"include"});case 2:return c=e.sent,e.next=5,c.json();case 5:(s=e.sent).accesstoken&&t(s.accesstoken);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),Object(p.jsx)("div",{className:"container",children:Object(p.jsx)(j.a,{children:Object(p.jsx)(Y,{})})})};r.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(A,{children:Object(p.jsx)(P,{children:Object(p.jsx)(Q,{})})})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.4ec0ae4c.chunk.js.map