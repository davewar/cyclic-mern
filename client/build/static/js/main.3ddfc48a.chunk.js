(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{31:function(e,t,c){},40:function(e,t,c){"use strict";c.r(t);var s=c(1),a=c.n(s),r=c(23),n=c.n(r),i=(c(31),c(3)),l=c.n(i),o=c(5),d=c(4),j="/products",b="/signup",u="/signin",m="/product_create",h="/history",O=c(6),x=c(0),p=function(){return Object(x.jsx)("div",{className:"container-lg border border-warning pt-5 pb-5 mt-6 ",children:Object(x.jsx)("div",{className:"row d-flex justify-content-center align-items-center ",children:Object(x.jsxs)("div",{className:"col-xs-12",children:[Object(x.jsx)("h1",{className:"text-center mt-5 ",children:"Welcome to My fullstack Website"}),Object(x.jsx)("h5",{className:"mt-5",children:"FrontEnd"}),Object(x.jsxs)("ul",{className:"list-unstyled",children:[Object(x.jsx)("li",{children:"- React"}),Object(x.jsx)("li",{children:"- Bootstrap"}),Object(x.jsx)("li",{children:"- Paypal"}),Object(x.jsx)("li",{children:"- Login/Register "}),Object(x.jsx)("li",{children:"- Admin user - Add / Delete / Amend Products"}),Object(x.jsx)("li",{children:"- Activate account by validating email address of user (Nodemailer)"}),Object(x.jsx)("li",{children:"- Password Reset (Nodemailer)"}),Object(x.jsx)("li",{children:"- Account locked - password incorrect three times in a row"})]}),Object(x.jsx)("h5",{className:"mt-5",children:"BackEnd"}),Object(x.jsxs)("ul",{className:"list-unstyled",children:[Object(x.jsx)("li",{children:"- NodeJS"}),Object(x.jsx)("li",{children:"- Express"}),Object(x.jsx)("li",{children:"- MongoDB"}),Object(x.jsx)("li",{children:"- JWT AccessToken && RefreshToken + HTTP only cookie"})]}),Object(x.jsx)("button",{className:"btn btn-primary",onClick:function(){window.open("https://github.com/davewar/React_shop_Nodemailer")},children:"GitHub Code"})]})})})},f=function(){return Object(x.jsxs)("div",{children:[Object(x.jsx)("h1",{children:"Error Page"}),Object(x.jsx)(d.b,{to:"/",children:"Back Home"})]})},v=c(17),g=c(8),N=c(25),y=c(2),w=function(e){localStorage.setItem("basket",JSON.stringify(e))},S=function(){localStorage.removeItem("basket")},k=Object(s.createContext)(),C=function(e){var t=e.children,c=Object(s.useState)([]),a=Object(y.a)(c,2),r=a[0],n=a[1],i=Object(s.useState)(0),l=Object(y.a)(i,2),o=l[0],d=l[1],j=Object(s.useState)([]),b=Object(y.a)(j,2),u=b[0],m=b[1],h=Object(s.useState)([]),O=Object(y.a)(h,2),p=O[0],f=O[1],v=Object(s.useState)("all"),C=Object(y.a)(v,2),P=C[0],E=C[1],A=Object(s.useState)(""),I=Object(y.a)(A,2),T=I[0],_=I[1];return Object(x.jsx)(k.Provider,{value:{products:r,setProducts:n,cart:u,setCart:m,addItem:function(e){var t=e.price,c=e._id,s=e.title,a=e.image,r=e.countInStock,n={_id:c,title:s,price:t,countInStock:r,image:a,count:1};if(u.every((function(e){return e._id!==c}))){var i=[].concat(Object(N.a)(u),[n]);m(i),w(i),alert("Item added to cart.")}else{var l=u.map((function(e){return e._id===c?Object(g.a)(Object(g.a)({},e),{},{count:e.count+1}):e}));m(l),w(l),alert("Item added to cart.")}},reduceQty:function(e){var t=u.map((function(t){return t._id===e?1===t.count?Object(g.a)(Object(g.a)({},t),{},{count:t.count=1}):Object(g.a)(Object(g.a)({},t),{},{count:t.count-1}):t}));m(t),w(t)},increaseQty:function(e){var t=u.map((function(t){return t._id===e?Object(g.a)(Object(g.a)({},t),{},{count:t.count+1}):t}));m(t),w(t)},removeItem:function(e){var t=u.filter((function(t){return t._id!==e}));m(t),w(t)},clearBasket:function(){m([]),d(0),S()},total:o,getTotal:function(){var e=u.reduce((function(e,t){return e+t.price*t.count}),0);d(e)},categorySelection:P,setCategorySelection:E,search:T,setSearch:_,categorysGlobal:p,setCategorysGlobal:f},children:t})},P=Object(s.createContext)(),E=function(e){var t=e.children,c=Object(s.useState)(""),a=Object(y.a)(c,2),r=a[0],n=a[1],i=Object(s.useState)(""),d=Object(y.a)(i,2),j=d[0],b=d[1],u=Object(s.useState)(!1),m=Object(y.a)(u,2),h=m[0],O=m[1],p=Object(s.useState)(!1),f=Object(y.a)(p,2),v=f[0],g=f[1],N=Object(s.useState)([]),w=Object(y.a)(N,2),S=w[0],k=w[1];return Object(s.useEffect)((function(){j&&function(){var e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/user/infor",{headers:{Authorization:j}});case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,O(!0),n(c.name),1===c.role?g(!0):g(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("DW",e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}()()}),[j]),Object(x.jsx)(P.Provider,{value:{user:r,setUser:n,isLogged:h,setIsLogged:O,isAdmin:v,setIsAdmin:g,accessToken:j,setAccessToken:b,history:S,setHistory:k},children:t})},A=function(){var e=Object(s.useContext)(k).cart,t=Object(s.useContext)(P),c=t.isLogged,a=t.isAdmin,r=t.setIsLogged,n=t.setIsAdmin,i=t.setAccessToken,O=t.setUser,p=t.user,f=function(){var e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user/logout");case 2:localStorage.removeItem("firstLogin"),r(!1),n(!1),i(""),O("");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"container-lg",children:[p&&Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-12",children:Object(x.jsx)("h4",{className:"mt-2 d-flex justify-content-center",children:p})})}),Object(x.jsxs)("div",{className:"row mt-5",children:[Object(x.jsx)("div",{className:"col-6 pl-0 pr-0",children:Object(x.jsx)("nav",{className:" navbar-nav navbar-expand-md navbar-light",children:Object(x.jsxs)("ul",{className:"navbar-nav justify-content-between",children:[Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(d.b,{className:"nav-item nav-link active",to:"/",children:"Home"})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(d.b,{className:"nav-item nav-link",to:j,children:"Products"})}),c&&Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(d.b,{className:"nav-item nav-link",to:h,children:"Account"})}),!c&&Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(d.b,{className:"nav-item nav-link",to:u,children:"SignIn"})}),c&&Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(d.b,{className:"nav-item nav-link",onClick:f,to:"/",children:"SignOut"})}),!c&&Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(d.b,{className:"nav-item nav-link",to:b,children:"Register"})}),a&&c&&Object(x.jsx)("li",{className:"nav-item ",children:Object(x.jsx)(d.b,{className:"nav-item nav-link text-success  ",to:m,children:"AddProduct"})})]})})}),Object(x.jsx)("div",{className:"col-6",children:Object(x.jsx)("div",{className:"d-flex  mt-5 justify-content-end mr-0",children:Object(x.jsxs)("span",{children:[Object(x.jsx)(d.b,{to:"/cart",children:Object(x.jsx)(v.a,{style:{height:"3rem",color:"#007bff",width:"3rem"}})}),Object(x.jsx)("span",{className:" border rounded-circle",style:{height:"rem",color:"black",fontWeight:"bold",border:"none transparent",width:"2.25rem"},children:function(){var t=0;return e?(e.forEach((function(e){var c=e.count;t+=c})),t):t}()})]})})})]})]})})},I=function(){var e=Object(s.useContext)(k),t=e.search,c=e.setSearch,a=e.categorySelection,r=e.setCategorySelection,n=e.setCategorysGlobal,i=Object(s.useState)(null),d=Object(y.a)(i,2),j=d[0],b=d[1],u=Object(s.useState)(!0),m=Object(y.a)(u,2),h=m[0],O=m[1],p=Object(s.useState)(!1),f=Object(y.a)(p,2),v=f[0],g=f[1],N=function(){var e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/category");case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,b(c),n(c),O(!1),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0.message),g(!0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){return N(),function(){!1}}),[]);return Object(x.jsxs)(x.Fragment,{children:[h&&Object(x.jsx)("div",{children:"Loading........"}),v&&Object(x.jsx)("div",{className:"mb-3 mt-4",children:"Error with loading of page. Please refresh page."}),Object(x.jsx)("div",{className:"container mb-5 ",children:j&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-8-md  mb-2",children:Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)("input",{type:"text",className:"form-control",value:t,onChange:function(e){return c(e.target.value)},placeholder:"Search..."})})})}),Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col-6 ml-0",children:[Object(x.jsx)("span",{children:" Filters: "}),Object(x.jsxs)("select",{name:"category",value:a,onChange:function(e){var t=e.target.value;r(t)},children:[Object(x.jsx)("option",{value:"all",children:"All Products"}),j.map((function(e){return Object(x.jsx)("option",{value:e.name,children:e.name},e._id)}))]})]})})]})})]})},T={},_=function(){var e,t=Object(s.useContext)(k),c=t.addItem,a=t.products,r=t.setProducts,n=t.search,i=t.categorySelection,j=Object(s.useContext)(P),b=j.isAdmin,u=j.accessToken,m=Object(s.useState)(!0),h=Object(y.a)(m,2),O=h[0],p=h[1],f=Object(s.useState)(!1),v=Object(y.a)(f,2),g=v[0],N=v[1],w=function(){var e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/products");case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,r(c),p(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message),N(!0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(o.a)(l.a.mark((function e(t){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/products/"+t,{method:"DELETE",body:JSON.stringify({id:t}),headers:{"Content-Type":"application/json",credentials:"include",Authorization:u}});case 3:return c=e.sent,e.next=6,c.json();case 6:"item deleted"!==(s=e.sent)?alert("Admin access lasts 10 mins, please refresh page and try again."):alert(s),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message),N(!0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){return w(),function(){!1}}),[]),e=(e="all"===i?a:a.filter((function(e){return e.category.toLowerCase()===i.toLowerCase()}))).filter((function(e){return e.title.toLowerCase().includes(n.toLowerCase())})),Object(x.jsxs)(x.Fragment,{children:[O&&Object(x.jsx)("div",{children:"Loading........"}),g&&Object(x.jsx)("div",{className:"mb-2",children:"Error with loading of page. Please refresh page."}),Object(x.jsx)(I,{}),Object(x.jsx)("div",{className:"container d-flex flex-row flex-wrap justify-content-between col-xs-12  col-sm-12 p-0 border border-success",children:e.map((function(e){return Object(x.jsxs)("div",{className:"card col-xs-12 col-sm-12 col-md-12 col-lg-5  mb-5 mt-5 p-0  ",id:"card-css",style:T,children:[Object(x.jsx)("img",{src:e.image,className:"card-img-top",alt:""}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h2",{className:"card-title",children:e.title}),Object(x.jsxs)("p",{className:"card-text",children:["Category: ",e.category]}),Object(x.jsxs)("span",{children:["Price: \xa3",e.price]}),b&&Object(x.jsxs)("p",{className:"card-text",children:["Stock: ",e.countInStock]}),Object(x.jsxs)("p",{className:"card-text",children:["Description: ",e.description]})]}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("button",{className:"btn btn-primary border",onClick:function(){return c(e)},children:"BUY"}),Object(x.jsx)("button",{className:"btn border",children:Object(x.jsx)(d.b,{to:"/products/".concat(e._id),children:"VIEW"})})]}),b&&Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("button",{className:"btn btn-danger border",onClick:function(){return S(e._id)},children:"DELETE"}),Object(x.jsx)("button",{className:"btn btn-warning border",children:Object(x.jsx)(d.b,{to:"/product_amend/".concat(e._id),children:"EDIT"})})]})]},e._id)}))}),O||0!==e.length?null:Object(x.jsx)("h1",{children:"No items found"})]})},F=function(){var e=Object(s.useContext)(k),t=e.addItem,c=e.products,a=Object(s.useState)([]),r=Object(y.a)(a,2),n=r[0],i=r[1],l=Object(s.useState)(!0),o=Object(y.a)(l,2),b=o[0],u=o[1],m=Object(s.useState)(!1),h=Object(y.a)(m,2),p=h[0],f=h[1],v=Object(O.g)().id;Object(s.useEffect)((function(){try{var e=c.filter((function(e){return e._id===v}));i(e[0]),u(!1)}catch(t){console.log(t.message),f(!0)}return function(){return!0}}),[]);var g=n._id,N=n.title,w=n.description,S=n.price,C=n.image;return Object(x.jsxs)(x.Fragment,{children:[b&&Object(x.jsx)("div",{children:"Loading........"}),p&&Object(x.jsx)("div",{children:"Error with loading of page. Please refresh page."}),n?Object(x.jsxs)("div",{className:"card col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-2 mb-2 ",children:[Object(x.jsx)("img",{className:"card-img-top",src:C,alt:N}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h2",{className:"card-title",children:N}),Object(x.jsxs)("span",{children:["Price: \xa3 ",S]}),Object(x.jsx)("p",{className:"card-text",children:w})]}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("button",{className:"btn btn-primary border",onClick:function(){return t(n)},children:"BUY"}),Object(x.jsx)("button",{className:"btn border",children:Object(x.jsx)(d.b,{to:j,children:"Back to products"})})]})]},g):Object(x.jsx)("h1",{children:"Unable to display item. Please try later"})]})},L={width:"40%",minWidth:"450px"},D=function(){var e=Object(s.useContext)(k),t=e.cart,c=(e.setCart,e.increaseQty),a=e.reduceQty,r=e.removeItem,n=e.clearBasket,i=e.total,l=e.getTotal;Object(s.useContext)(P).accessToken;if(Object(s.useEffect)((function(){return l(),function(){return!0}}),[t]),!t||0===t.length)return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h1",{children:"No Items in basket"}),Object(x.jsx)("button",{className:"btn border",children:Object(x.jsx)(d.b,{to:"/products",children:"CONTINUE SHOPPING"})})]});return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-6 d-flex justify-content-start",children:Object(x.jsx)("h1",{className:"text-center text-uppercase text-secondary ",children:"Cart"})}),Object(x.jsx)("div",{className:"col-6 d-flex justify-content-end",children:Object(x.jsxs)("h3",{className:"text-center",children:["Total - \xa3 ",i]})})]}),Object(x.jsx)("div",{className:"row ",children:Object(x.jsx)("div",{className:"col-12 d-flex justify-content-start",children:Object(x.jsx)("button",{className:"btn btn-secondary",onClick:function(){return n()},children:"REMOVE ALL ITEMS"})})}),Object(x.jsx)("div",{className:"row mb-5",children:Object(x.jsx)("div",{className:"col-12 d-flex justify-content-end"})}),Object(x.jsx)("div",{className:"container",children:Object(x.jsx)("div",{className:"d-flex flex-row flex-wrap justify-content-between",children:t?t.map((function(e){return Object(x.jsxs)("div",{className:"card mt-2 mb-4 t h-25",style:L,children:[Object(x.jsx)("img",{src:e.image,className:"card-img-top",alt:""}),Object(x.jsx)("div",{className:"card-body d-flex justify-content-end ",children:Object(x.jsx)("button",{className:"btn ",onClick:function(){return r(e._id)},children:Object(x.jsx)(v.b,{style:{height:"2rem",color:"black",width:"2rem"}})})}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h1",{className:"card-title",children:e.title}),Object(x.jsxs)("p",{className:"card-text",children:["Price: \xa3",e.price]}),Object(x.jsxs)("h4",{children:["Total Price: \xa3",e.price*e.count]})]}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("button",{className:"btn btn primary border mr-2",onClick:function(){return a(e._id)},children:[" ","-"," "]}),Object(x.jsx)("span",{className:"",children:e.count}),Object(x.jsxs)("button",{className:"btn btn primary border ml-2",onClick:function(){return c(e._id)},children:[" ","+"," "]})]}),Object(x.jsx)("button",{className:"btn border",children:Object(x.jsx)(d.b,{to:"/products",children:"CONTINUE SHOPPING"})})]},e._id)})):null})})]})},z=function(){var e=Object(s.useContext)(P).setAccessToken,t=Object(O.f)(),c=Object(s.useState)(""),a=Object(y.a)(c,2),r=a[0],n=a[1],i=Object(s.useState)(""),j=Object(y.a)(i,2),b=j[0],u=j[1],m=Object(s.useState)(""),h=Object(y.a)(m,2),p=h[0],f=h[1],v=Object(s.useState)(""),g=Object(y.a)(v,2),N=g[0],w=g[1],S=Object(s.useState)(""),k=Object(y.a)(S,2),C=k[0],E=k[1],A=function(e,t){n("");var c={},s=RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);switch(c[t]=e.target.value,t){case"email":u(c.email),s.test(c.email)?w(""):w("Invalid Email!");break;case"password":f(c.password),c.password.length<6?E("Password must be at least 6 characters!"):E("")}},I=function(){var c=Object(o.a)(l.a.mark((function c(s){var a,r;return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(s.preventDefault(),!b||!p||N||C){c.next=16;break}return n(""),c.prev=3,c.next=6,fetch("/user/login",{method:"POST",body:JSON.stringify({email:b,password:p}),headers:{"Content-Type":"application/json",credentials:"include"}});case 6:return a=c.sent,c.next=9,a.json();case 9:(r=c.sent).errors?n(r.errors):r.user&&(localStorage.setItem("firstLogin",!0),e(r.accesstoken),t.push("products")),c.next=16;break;case 13:c.prev=13,c.t0=c.catch(3),console.log(c.t0);case 16:case"end":return c.stop()}}),c,null,[[3,13]])})));return function(e){return c.apply(this,arguments)}}();return Object(x.jsx)("div",{className:" dcontainer-lg border border-warning pt-5 pb-5 mt-6 ",children:Object(x.jsx)("div",{className:"row d-flex justify-content-center align-items-center ",children:Object(x.jsxs)("div",{className:"col-xs-12  sign-in",children:[Object(x.jsx)("h2",{className:"text-start mt-3",children:"Sign In"}),r&&Object(x.jsx)("div",{className:"alert alert-danger text-center",children:Object(x.jsx)("span",{className:"text-danger text-capitalize",children:r})}),Object(x.jsxs)("form",{className:"mt-4 ",onSubmit:I,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{className:"mr-3",htmlFor:"email",children:"Enter Email Address"}),Object(x.jsx)("input",{type:"email",name:"email",className:N?"form-control is-invalid":!N&&b.length?"form-control is-valid":"form-control",id:"email",placeholder:"Email Address",required:!0,autoComplete:"on",onChange:function(e){return A(e,"email")}}),N&&Object(x.jsx)("small",{className:"text-danger",children:N})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{className:"",htmlFor:"password",children:"Enter Password"}),Object(x.jsx)("input",{type:"password",name:"password",className:C?"form-control is-invalid":!C&&p.length?"form-control is-valid":"form-control",id:"password",placeholder:"Password",required:!0,autoComplete:"off",onChange:function(e){return A(e,"password")}}),C&&Object(x.jsx)("small",{className:"text-danger",children:C})]}),Object(x.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Sign In"})]}),Object(x.jsxs)("p",{className:"float-left mt-2",children:["Don't yet have an account?",Object(x.jsx)(d.b,{to:"/signup",children:"Sign up"})]}),Object(x.jsx)("div",{className:"mt-2 ms-2 ",children:Object(x.jsx)(d.b,{to:"/reset",children:"Forgot Password"})})]})})})},B=function(){var e=Object(s.useState)(""),t=Object(y.a)(e,2),c=t[0],a=t[1],r=Object(s.useState)(""),n=Object(y.a)(r,2),i=n[0],j=n[1],b=Object(s.useState)(""),u=Object(y.a)(b,2),m=u[0],h=u[1],O=Object(s.useState)(""),p=Object(y.a)(O,2),f=p[0],v=p[1],g=Object(s.useState)(""),N=Object(y.a)(g,2),w=N[0],S=N[1],k=Object(s.useState)(""),C=Object(y.a)(k,2),P=C[0],E=C[1],A=Object(s.useState)(""),I=Object(y.a)(A,2),T=I[0],_=I[1],F=Object(s.useState)(""),L=Object(y.a)(F,2),D=L[0],z=L[1],B=Object(s.useState)(""),q=Object(y.a)(B,2),J=q[0],H=q[1],G=Object(s.useState)(""),R=Object(y.a)(G,2),U=R[0],M=R[1],W=function(e,t){a("");var c={},s=RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);switch(c[t]=e.target.value,t){case"name":j(c.name),c.name.length<3?E("Name must be at least 3 characters!"):E("");break;case"email":h(c.email),s.test(c.email)?_(""):_("Invalid Email!");break;case"password":v(c.password),c.password.length<6?z("Password must be at least 6 characters!"):z("");break;case"confPassword":S(c.confPassword),c.confPassword!==f?H("Passwords do not match!"):H("")}},Z=function(){var e=Object(o.a)(l.a.mark((function e(t){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(i&&m&&f&&w)||P||T||D||J){e.next=18;break}return a(""),M(""),e.prev=4,e.next=7,fetch("/user/signup",{method:"POST",body:JSON.stringify({name:i,email:m,password:f}),headers:{"Content-Type":"application/json",credentials:"include"}});case 7:return c=e.sent,e.next=10,c.json();case 10:(s=e.sent).errors&&a(s.errors),s.msg&&M(s.msg),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.log(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"container-lg border border-warning pt-5 pb-5 mt-6 ",children:Object(x.jsx)("div",{className:"row d-flex justify-content-center align-items-center ",children:Object(x.jsxs)("div",{className:"col-xs-12 sign-in ",children:[Object(x.jsx)("h2",{className:"text-center",children:"Create an Account"}),c&&Object(x.jsx)("div",{className:"alert alert-danger text-center",children:Object(x.jsx)("span",{className:"text-danger text-capitalize",children:c})}),U&&Object(x.jsx)("div",{className:"alert alert-success text-center",children:Object(x.jsx)("span",{className:"text-success text-capitalize",children:U})}),Object(x.jsxs)("form",{className:"mt-4",onSubmit:Z,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"name",children:"Enter Full Name"}),Object(x.jsx)("input",{type:"text",name:"name",className:P?"form-control is-invalid":!P&&i.length?"form-control is-valid":"form-control",id:"name",placeholder:"Full Name",onChange:function(e){return W(e,"name")}}),P&&Object(x.jsx)("small",{className:"text-danger",children:P})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"email",children:"Enter Email Address"}),Object(x.jsx)("input",{type:"email",name:"email",className:T?"form-control is-invalid":!T&&m.length?"form-control is-valid":"form-control",id:"email",placeholder:"Email Address",onChange:function(e){return W(e,"email")}}),T&&Object(x.jsx)("small",{className:"text-danger",children:T})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"password",children:"Enter Password"}),Object(x.jsx)("input",{type:"password",name:"password",className:D?"form-control is-invalid":!D&&f.length?"form-control is-valid":"form-control",id:"password",placeholder:"Password",onChange:function(e){return W(e,"password")}}),D&&Object(x.jsx)("small",{className:"text-danger",children:D})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"Confirm Password",children:"Confirm Password"}),Object(x.jsx)("input",{type:"password",name:"confPassword",className:J?"form-control is-invalid":J||D||!w?"form-control":"form-control is-valid",id:"confPassword",placeholder:"Password",onChange:function(e){return W(e,"confPassword")}}),J&&Object(x.jsx)("small",{className:"text-danger",children:J})]}),Object(x.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Sign Up"})]}),Object(x.jsxs)("p",{className:"float-left",children:["Already have an account?",Object(x.jsx)(d.b,{to:"/signin",children:"Log In"})]})]})})})},q=function(){var e=Object(s.useContext)(P),t=e.history,c=e.setHistory,a=e.accessToken,r=e.isAdmin,n=Object(s.useState)(!0),i=Object(y.a)(n,2),b=i[0],u=i[1],m=Object(s.useState)(!1),h=Object(y.a)(m,2),O=h[0],p=h[1];return Object(s.useEffect)((function(){return function(){var e=Object(o.a)(l.a.mark((function e(){var t,s,n,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=19;break}return e.prev=1,e.next=4,fetch("/api/payments",{headers:{Authorization:a}});case 4:return t=e.sent,e.next=7,t.json();case 7:s=e.sent,c(s),u(!1),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0.message),c([]),p(!0);case 17:e.next=35;break;case 19:return e.prev=19,e.next=22,fetch("/user/history",{headers:{Authorization:a}});case 22:return n=e.sent,e.next=25,n.json();case 25:i=e.sent,c(i),u(!1),e.next=35;break;case 30:e.prev=30,e.t1=e.catch(19),console.log(e.t1.message),c([]),p(!0);case 35:case"end":return e.stop()}}),e,null,[[1,12],[19,30]])})));return function(){return e.apply(this,arguments)}}()(),function(){return!0}}),[a,c,r]),O?Object(x.jsx)("div",{children:"Error with loading of page. Please refresh page."}):Object(x.jsxs)(x.Fragment,{children:[b&&Object(x.jsx)("div",{children:"Loading........"}),O&&Object(x.jsx)("div",{children:"Error with loading of page. Please refresh page."}),t.length>0?Object(x.jsxs)("div",{className:"container",children:[Object(x.jsxs)("div",{className:"row ",children:[Object(x.jsx)("h2",{children:"Account History"}),Object(x.jsx)("button",{className:"btn ",children:Object(x.jsx)(d.b,{to:j,children:"Back to products"})})]}),Object(x.jsxs)("p",{children:["You have ",t.length," purchases"]}),Object(x.jsxs)("table",{className:"table table-hover ",children:[Object(x.jsx)("thead",{className:"thead-dark",children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{scope:"col",children:"Payment ID"}),Object(x.jsx)("th",{scope:"col",children:"Date of Purchased"}),Object(x.jsx)("th",{scope:"col"})]})}),Object(x.jsx)("tbody",{children:t.map((function(e){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:e.paymentID}),Object(x.jsx)("td",{children:new Date(e.createdAt).toLocaleDateString()}),Object(x.jsx)("td",{children:Object(x.jsx)(d.b,{to:"/history/".concat(e._id),children:"View"})})]},e._id)}))})]})]}):Object(x.jsx)("p",{children:"You have 0 purchases"})]})};var J=function(){var e=Object(s.useContext)(P).history,t=Object(s.useState)([]),c=Object(y.a)(t,2),a=c[0],r=c[1],n=Object(O.g)().id;return Object(s.useEffect)((function(){n&&e.forEach((function(e){e._id===n&&r(e)}))}),[n,e]),0===a.length?null:Object(x.jsxs)("div",{className:"container mt-1",children:[Object(x.jsx)("button",{className:"btn",children:Object(x.jsx)(d.b,{to:h,children:"Back to accounts"})}),Object(x.jsxs)("table",{className:"table table-bordered mt-3",children:[Object(x.jsx)("thead",{className:"thead-dark",children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Name"}),Object(x.jsx)("th",{children:"Address"}),Object(x.jsx)("th",{children:"Postal Code"}),Object(x.jsx)("th",{children:"Country Code"})]})}),Object(x.jsx)("tbody",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:a.address.recipient_name}),Object(x.jsx)("td",{children:a.address.line1+" - "+a.address.city}),Object(x.jsx)("td",{children:a.address.postal_code}),Object(x.jsx)("td",{children:a.address.country_code})]})})]}),Object(x.jsxs)("table",{className:"table table-bordered",children:[Object(x.jsx)("thead",{className:"thead-dark",children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Products"}),Object(x.jsx)("th",{children:"Quantity"}),Object(x.jsx)("th",{children:"Price"}),Object(x.jsx)("th",{children:"Total"}),Object(x.jsx)("th",{children:"Dispatched"})]})}),Object(x.jsx)("tbody",{children:a.cart.map((function(e){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:e.title}),Object(x.jsx)("td",{children:e.count}),Object(x.jsx)("td",{children:e.price}),Object(x.jsxs)("td",{children:["\xa3 ",e.price*e.count]}),Object(x.jsx)("td",{children:e.Sent?"Yes":"No"})]},e._id)}))})]})]})},H=function(){var e=Object(s.useState)(""),t=Object(y.a)(e,2),c=t[0],a=t[1],r=Object(s.useState)(""),n=Object(y.a)(r,2),i=n[0],d=n[1],j=Object(O.g)().id;console.log(j);var b=function(){var e=Object(o.a)(l.a.mark((function e(t){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/user/activation",{method:"POST",body:JSON.stringify({accesstoken:t}),headers:{"Content-Type":"application/json",credentials:"include"}});case 3:return c=e.sent,e.next=6,c.json();case 6:s=e.sent,console.log(s),s.errors?a(s.errors):d(s.msg),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message),a(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){return b(j),function(){!1}}),[j]),Object(x.jsxs)("div",{className:"alert",children:[Object(x.jsx)("p",{className:"text-danger",children:c}),Object(x.jsx)("p",{className:"text-success",children:i})]})},G=function(){var e=Object(s.useState)(""),t=Object(y.a)(e,2),c=t[0],a=t[1],r=Object(s.useState)(""),n=Object(y.a)(r,2),i=n[0],j=n[1],b=Object(s.useState)(""),u=Object(y.a)(b,2),m=u[0],h=u[1],O=Object(s.useState)(""),p=Object(y.a)(O,2),f=p[0],v=p[1],g=function(){var e=Object(o.a)(l.a.mark((function e(t){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!m||f){e.next=18;break}return a(""),j(""),e.prev=4,e.next=7,fetch("/user/forgot",{method:"POST",body:JSON.stringify({email:m}),headers:{"Content-Type":"application/json",credentials:"include"}});case 7:return c=e.sent,e.next=10,c.json();case 10:(s=e.sent).errors?a(s.errors):j(s.msg),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0),a(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"container-lg border border-warning pt-5 pb-5 mt-6 ",children:Object(x.jsx)("div",{className:"row d-flex justify-content-center align-items-center ",children:Object(x.jsxs)("div",{className:"col-xs-12  ",children:[Object(x.jsx)("h2",{className:"text-start mt-3",children:"Forgot Password"}),c&&Object(x.jsx)("div",{className:"alert alert-danger text-center",children:Object(x.jsx)("span",{className:"text-danger text-capitalize",children:c})}),i&&Object(x.jsx)("div",{className:"alert alert-success text-center",children:Object(x.jsx)("span",{className:"text-success text-capitalize",children:i})}),Object(x.jsxs)("form",{className:"mt-4 ",onSubmit:g,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{className:"mr-3",htmlFor:"email",children:"Enter Email Address"}),Object(x.jsx)("input",{type:"email",name:"email",className:f?"form-control is-invalid":!f&&m.length?"form-control is-valid":"form-control",id:"email",placeholder:"Email Address",required:!0,autoComplete:"on",onChange:function(e){return function(e,t){a(""),j(""),v("");var c={},s=RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);switch(c[t]=e.target.value,t){case"email":h(c.email),s.test(c.email)?v(""):v("Invalid Email!")}}(e,"email")}}),f&&Object(x.jsx)("small",{className:"text-danger",children:f})]}),Object(x.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Submit"})]}),Object(x.jsxs)("p",{className:"float-left mt-5",children:["Back to",Object(x.jsx)(d.b,{to:"/signin",children:"Sign in"})]})]})})})},R=function(){var e=Object(O.g)().id,t=Object(s.useState)(""),c=Object(y.a)(t,2),a=c[0],r=c[1],n=Object(s.useState)(""),i=Object(y.a)(n,2),j=i[0],b=i[1],u=Object(s.useState)(""),m=Object(y.a)(u,2),h=m[0],p=m[1],f=Object(s.useState)(""),v=Object(y.a)(f,2),g=v[0],N=v[1],w=Object(s.useState)(""),S=Object(y.a)(w,2),k=S[0],C=S[1],P=Object(s.useState)(""),E=Object(y.a)(P,2),A=E[0],I=E[1],T=Object(s.useState)(""),_=Object(y.a)(T,2),F=_[0],L=_[1],D=Object(s.useState)(""),z=Object(y.a)(D,2),B=z[0],q=z[1],J=function(e,t){r("");var c={},s=RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);switch(c[t]=e.target.value,t){case"email":b(c.email),s.test(c.email)?C(""):C("Invalid Email!");break;case"password":p(c.password),c.password.length<6?I("Password must be at least 6 characters!"):I("");break;case"confPassword":N(c.confPassword),c.confPassword!==h?L("Passwords do not match!"):L("")}},H=function(){var t=Object(o.a)(l.a.mark((function t(c){var s,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c.preventDefault(),!(j&&h&&g)||k||A||F){t.next=19;break}return r(""),q(""),t.prev=4,t.next=7,fetch("/user/reset",{method:"POST",body:JSON.stringify({email:j,password:h,accesstoken:e}),headers:{"Content-Type":"application/json",credentials:"include"}});case 7:return s=t.sent,t.next=10,s.json();case 10:a=t.sent,console.log(a),a.errors&&r(a.errors),a.msg&&(console.log(a),q(a.msg)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),console.log(t.t0.message);case 19:case"end":return t.stop()}}),t,null,[[4,16]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"container-lg border border-warning pt-5 pb-5 mt-6 ",children:Object(x.jsx)("div",{className:"row d-flex justify-content-center align-items-center ",children:Object(x.jsxs)("div",{className:"col-xs-12 ",children:[Object(x.jsx)("h2",{className:"text-center",children:"Create your Password"}),a&&Object(x.jsx)("div",{className:"alert alert-danger text-center",children:Object(x.jsx)("span",{className:"text-danger text-capitalize",children:a})}),B&&Object(x.jsx)("div",{className:"alert alert-success text-center",children:Object(x.jsx)("span",{className:"text-success text-capitalize",children:B})}),Object(x.jsxs)("form",{className:"mt-4",onSubmit:H,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"email",children:"Enter Email Address"}),Object(x.jsx)("input",{type:"email",name:"email",className:k?"form-control is-invalid":!k&&j.length?"form-control is-valid":"form-control",id:"email",placeholder:"Email Address",onChange:function(e){return J(e,"email")}}),k&&Object(x.jsx)("small",{className:"text-danger",children:k})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"password",children:"Enter Password"}),Object(x.jsx)("input",{type:"password",name:"password",className:A?"form-control is-invalid":!A&&h.length?"form-control is-valid":"form-control",id:"password",placeholder:"Password",onChange:function(e){return J(e,"password")}}),A&&Object(x.jsx)("small",{className:"text-danger",children:A})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"Confirm Password",children:"Confirm Password"}),Object(x.jsx)("input",{type:"password",name:"confPassword",className:F?"form-control is-invalid":F||A||!g?"form-control":"form-control is-valid",id:"confPassword",placeholder:"Password",onChange:function(e){return J(e,"confPassword")}}),F&&Object(x.jsx)("small",{className:"text-danger",children:F})]}),Object(x.jsx)("input",{type:"submit",className:"btn btn-primary",value:"Submit"})]}),Object(x.jsx)("p",{className:"float-left mt-5",children:Object(x.jsx)(d.b,{to:"/signin",children:"Log In"})})]})})})},U=c(13),M={title:"",image:"",price:"",description:"",category:"",countInStock:""};var W=function(){var e=Object(s.useContext)(P),t=e.isAdmin,c=e.accessToken,a=Object(s.useContext)(k),r=a.categorysGlobal,n=a.setCategorysGlobal,i=Object(s.useState)(M),d=Object(y.a)(i,2),j=d[0],b=d[1],u=Object(s.useState)(!0),m=Object(y.a)(u,2),h=m[0],O=m[1],p=Object(s.useState)(!1),f=Object(y.a)(p,2),v=f[0],N=f[1],w=function(){var e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/category");case 3:return t=e.sent,e.next=6,t.json();case 6:c=e.sent,n(c),O(!1),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message),O(!1),N(!0);case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){return w(),function(){!1}}),[]);var S=function(e){var t=e.target,c=t.name,s=t.value;("price"===c||"countInStock"===c)&&s<0||b(Object(g.a)(Object(g.a)({},j),{},Object(U.a)({},c,s)))},C=function(){var e=Object(o.a)(l.a.mark((function e(s){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),e.prev=1,t){e.next=4;break}return e.abrupt("return",alert("Unauthorised"));case 4:if(""!==j.category){e.next=7;break}return alert("Please select a category"),e.abrupt("return");case 7:return e.next=9,fetch("/api/products/add",{method:"POST",body:JSON.stringify(Object(g.a)({},j)),headers:{"Content-Type":"application/json",credentials:"include",Authorization:c}});case 9:return a=e.sent,e.next=12,a.json();case 12:r=e.sent,console.log(r),"item added"!==r?alert("Admin access lasts 10 mins, please refresh page and try again."):(alert(r),b(M)),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),alert(e.t0.message);case 20:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(x.Fragment,{children:[h&&Object(x.jsx)("div",{children:"Loading........"}),v&&Object(x.jsx)("div",{children:"Error with loading of page. Please refresh page."}),r&&Object(x.jsxs)("form",{onSubmit:C,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Title"}),Object(x.jsx)("input",{type:"text",name:"title",className:"form-control",required:!0,placeholder:"Shirt",value:j.title,onChange:S})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Image"}),Object(x.jsx)("input",{type:"text",name:"image",className:"form-control",required:!0,placeholder:"https://images.unsplash.com/photo-1606813907291-d86efa9b94db?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1352&q=80",value:j.image,onChange:S})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Price"}),Object(x.jsx)("input",{type:"number",name:"price",className:"form-control",required:!0,placeholder:"1.00",value:j.price,onChange:S})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Description"}),Object(x.jsx)("textarea",{type:"text",name:"description",className:"form-control",required:!0,placeholder:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Non assumenda maiores vero, consequuntur",value:j.description,rows:"5",onChange:S})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Categories: "}),Object(x.jsxs)("select",{name:"category",value:j.category,className:"form-control",onChange:S,children:[Object(x.jsx)("option",{value:"",children:"Please select a category"}),r.map((function(e){return Object(x.jsx)("option",{value:e.name,children:e.name},e._id)}))]})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Stock Count"}),Object(x.jsx)("input",{type:"number",name:"countInStock",className:"form-control",required:!0,placeholder:"0",value:j.countInStock,onChange:S})]}),Object(x.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Add"})]})]})};var Z=function(){var e=Object(O.g)().id,t=Object(s.useContext)(P),c=t.isAdmin,a=t.accessToken,r=Object(s.useContext)(k),n=r.categorysGlobal,i=r.products,b=Object(s.useState)(),u=Object(y.a)(b,2),m=u[0],h=u[1],p=Object(s.useState)(!0),f=Object(y.a)(p,2),v=f[0],N=f[1],w=Object(s.useState)(!1),S=Object(y.a)(w,2),C=S[0],E=S[1];Object(s.useEffect)((function(){try{var t=i.filter((function(t){return t._id===e}));h(t[0]),N(!1)}catch(c){console.log(c.message),E(!0)}return function(){return!0}}),[]);var A=function(e){var t=e.target,c=t.name,s=t.value;console.log(c,s),("price"===c||"countInStock"===c)&&s<0||h(Object(g.a)(Object(g.a)({},m),{},Object(U.a)({},c,s)))},I=function(){var t=Object(o.a)(l.a.mark((function t(s){var r,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),t.prev=1,c){t.next=4;break}return t.abrupt("return",alert("Unauthorised"));case 4:if(""!==m.category){t.next=7;break}return alert("Please select a category"),t.abrupt("return");case 7:return console.log(m),t.next=10,fetch("/api/products/update/"+e,{method:"POST",body:JSON.stringify(Object(g.a)({},m)),headers:{"Content-Type":"application/json",credentials:"include",Authorization:a}});case 10:return r=t.sent,t.next=13,r.json();case 13:n=t.sent,console.log(n),"item updated"!==n?alert("Admin access lasts 10 mins, please refresh page and try again."):alert(n),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(1),alert(t.t0.message);case 21:case"end":return t.stop()}}),t,null,[[1,18]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsxs)(x.Fragment,{children:[v&&Object(x.jsx)("div",{children:"Loading........"}),C&&Object(x.jsx)("div",{children:"Error with loading of page. Please refresh page."}),m&&Object(x.jsxs)("form",{onSubmit:I,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Title"}),Object(x.jsx)("input",{type:"text",name:"title",className:"form-control",required:!0,value:m.title,onChange:A})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Image"}),Object(x.jsx)("input",{type:"text",name:"image",className:"form-control",required:!0,value:m.image,onChange:A})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Price"}),Object(x.jsx)("input",{type:"number",name:"price",className:"form-control",required:!0,value:m.price,onChange:A})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Description"}),Object(x.jsx)("textarea",{type:"text",name:"description",className:"form-control",required:!0,value:m.description,rows:"5",onChange:A})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Categories: "}),Object(x.jsx)("select",{name:"category",value:m.category,className:"form-control",onChange:A,children:n.map((function(e){return Object(x.jsx)("option",{value:e.name,children:e.name},e._id)}))})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Stock Count"}),Object(x.jsx)("input",{type:"number",name:"countInStock",className:"form-control",required:!0,value:m.countInStock,onChange:A})]}),Object(x.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Save"}),Object(x.jsx)("button",{className:"btn border",children:Object(x.jsx)(d.b,{to:j,children:"Back to products"})}),Object(x.jsx)("div",{})]})]})},Y=function(){return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)(d.a,{children:[Object(x.jsx)(A,{}),Object(x.jsxs)(O.c,{children:[Object(x.jsx)(O.a,{exact:!0,path:"/",component:p}),Object(x.jsx)(O.a,{exact:!0,path:j,component:_}),Object(x.jsx)(O.a,{exact:!0,path:"/products/:id",component:F}),Object(x.jsx)(O.a,{path:"/cart",component:D}),Object(x.jsx)(O.a,{exact:!0,path:h,component:q}),Object(x.jsx)(O.a,{exact:!0,path:"/history/:id",component:J}),Object(x.jsx)(O.a,{path:u,component:z}),Object(x.jsx)(O.a,{path:b,component:B}),Object(x.jsx)(O.a,{path:"/user/activate/:id",component:H,exact:!0}),Object(x.jsx)(O.a,{path:"/reset",component:G,exact:!0}),Object(x.jsx)(O.a,{path:"/reset_password/:id",component:R,exact:!0}),Object(x.jsx)(O.a,{path:m,exact:!0,component:W}),Object(x.jsx)(O.a,{path:"/product_amend/:id",component:Z}),Object(x.jsx)(O.a,{path:"*",children:Object(x.jsx)(f,{})})]})]})})};c(39);var Q=function(){var e=Object(s.useContext)(k).setCart,t=Object(s.useContext)(P).setAccessToken;return Object(s.useEffect)((function(){var t=JSON.parse(localStorage.getItem("basket"));t&&e(t)}),[]),Object(s.useEffect)((function(){localStorage.getItem("firstLogin")&&function(){var e=Object(o.a)(l.a.mark((function e(){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user/refresh_token",{credentials:"include"});case 2:return c=e.sent,e.next=5,c.json();case 5:(s=e.sent).accesstoken&&t(s.accesstoken);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),Object(x.jsx)("div",{className:"container-lg border border-primary h-100 ",children:Object(x.jsx)(d.a,{children:Object(x.jsx)(Y,{})})})},V=c(26);Object(V.a)(),n.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(E,{children:Object(x.jsx)(C,{children:Object(x.jsx)(Q,{})})})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.3ddfc48a.chunk.js.map